<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>성주 경영 시뮬레이션 MVP</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <header class="topbar">
    <div class="title">
      <h1>성주 경영 시뮬레이션 (MVP)</h1>
      <p class="subtitle">식량/노동/건설/세금 + 사건 + 치안/정통성의 최소 구현</p>
    </div>
    <div class="topbar-right">
      <div class="version">v0.1.1</div>
      <div class="controls">
        <button id="btnTick">하루 진행</button>
        <button id="btnAuto">자동 진행: OFF</button>
        <button id="btnSave">저장</button>
        <button id="btnLoad">불러오기</button>
        <button id="btnHelp">도움말 ?</button>
        <button id="btnReset" class="danger">초기화</button>
      </div>
    </div>
  </header>

  <main class="layout">
    <section class="card span-7">
      <h2>현황</h2>
      <div class="grid stats" id="stats"></div>
      <div class="security-alert muted" id="securityAlert"></div>
      <div class="security-help muted small">치안은 경비 인력과 성벽으로 올릴 수 있습니다.</div>
      <div class="hint" id="hints"></div>
    </section>

    <section class="card span-5">
      <h2>노동 배치</h2>
      <p class="muted">총 노동력 내에서 직업을 배치하세요. 생산/치안/건설 효율이 바뀝니다.</p>
      <div class="grid" id="jobs"></div>

      <div class="row">
        <label>세율(주간): <span id="taxLabel"></span></label>
        <input id="taxRate" type="range" min="0" max="30" step="1" />
      </div>
      <p class="muted small">세율↑ → 금고↑ (주간) / 행복↓·정통성↓ 압박(일 단위).</p>
    </section>

    <section class="card span-7">
      <h2>건설</h2>
      <p class="muted">건설은 자원과 금을 소모합니다. 일부 건물은 매일 유지비가 듭니다.</p>
      <div class="grid buildings" id="buildings"></div>
    </section>

    <section class="card span-5">
      <h2>로그</h2>
      <div id="log" class="log"></div>
    </section>
  </main>

  <div id="modal" class="modal hidden" role="dialog" aria-modal="true">
    <div class="modal-inner">
      <h3 id="modalTitle"></h3>
      <p id="modalBody"></p>
      <div id="modalChoices" class="choices"></div>
    </div>
  </div>

  <div id="helpModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="helpTitle">
    <div class="modal-inner">
      <h3 id="helpTitle">도움말 / How to Play</h3>
      <div class="modal-body help-content">
        <p class="help-title">도움말 / How to Play</p>
        <div class="help-section">
          <p class="help-heading">A. 30초 요약</p>
          <ul>
            <li>당신은 성주입니다. 식량·노동·건설·세금을 운영해 마을을 성장시키세요.</li>
            <li>매일(하루 진행) 자원이 변하고 사건이 발생할 수 있습니다.</li>
            <li>치안이 낮으면 범죄, 더 나쁘면 폭동으로 이어질 수 있어요.</li>
          </ul>
        </div>
        <div class="help-section">
          <p class="help-heading">B. 기본 조작</p>
          <ul>
            <li>하루 진행: 하루를 넘깁니다(자원 생산/소비, 상태 변화, 사건 체크).</li>
            <li>자동 진행: 일정 간격으로 하루 진행을 자동 반복합니다.</li>
            <li>저장/불러오기: 현재 상태를 브라우저에 저장/복구합니다.</li>
            <li>초기화: 새 게임 시작(저장과 별개일 수 있으니 문구로 경고 추천).</li>
          </ul>
        </div>
        <div class="help-section">
          <p class="help-heading">C. 핵심 지표 설명</p>
          <ul>
            <li>노동력: 일할 수 있는 사람 수. 각 작업(농부/벌목/건설/경비)에 배치.</li>
            <li>식량: 매일 소비됩니다. 0에 가까워지면 행복/인구에 악영향.</li>
            <li>목재/돌: 건설 재료. 성벽·주거·시설 건설에 필요.</li>
            <li>금고(골드): 세금/거래/선택지 비용에 사용.</li>
            <li>행복: 낮으면 생산/안정에 악영향, 폭동 위험도 증가.</li>
            <li>치안: 낮으면 범죄가 늘고, 매우 낮으면 폭동 위험. 경비 인력과 성벽으로 올릴 수 있음.</li>
            <li>정통성: 통치에 대한 신뢰. 낮으면 사건에서 불리한 결과가 나기 쉬움.</li>
          </ul>
        </div>
        <div class="help-section">
          <p class="help-heading">D. 노동 배치 팁</p>
          <ul>
            <li>농부: 식량 기반. 초반에 최소한 확보.</li>
            <li>경비: 치안 유지. 경비가 너무 적으면 범죄가 자주 발생할 수 있음.</li>
            <li>건설: 건물을 빨리 올리고 싶을 때 집중 배치.</li>
            <li>벌목: 목재 수급이 막히면 중장기 확장 불가.</li>
          </ul>
        </div>
        <div class="help-section">
          <p class="help-heading">E. 건설 우선순위(초보 추천 루트)</p>
          <ul>
            <li>1) 농장/식량 관련(식량 적자 방지)</li>
            <li>2) 주거(인구/노동 확장 기반)</li>
            <li>3) 저장고(최대 보유량 증가)</li>
            <li>4) 성벽/치안 시설(범죄/폭동 억제)</li>
            <li>5) 선술집/의무소(행복/재난 완화)</li>
          </ul>
        </div>
        <div class="help-section">
          <p class="help-heading">F. 세금과 사건</p>
          <ul>
            <li>세금↑: 금은 늘지만 행복/정통성에 부담이 될 수 있습니다.</li>
            <li>사건(약탈/가뭄/상단/전염병 등)은 선택에 따라 자원/지표가 변합니다.</li>
            <li>장기적으로는 안정(치안/행복/정통성)이 곧 성장의 연료입니다.</li>
          </ul>
        </div>
        <div class="help-section">
          <p class="help-heading">G. 치안→범죄→폭동(중요)</p>
          <ul>
            <li>치안이 낮으면 범죄 확률 상승: 금 손실 + (행복/정통성) 손실이 발생할 수 있습니다.</li>
            <li>치안/행복이 매우 낮은 상태가 누적되면 폭동 위험:
              <ul>
                <li>강경 진압(치안↑, 정통성↓, 인구↓ 가능)</li>
                <li>구휼/보상(금/식량↓, 행복↑, 정통성↑)</li>
                <li>방치(즉시 비용 없음, 대신 이후 위험↑)</li>
              </ul>
            </li>
          </ul>
        </div>
        <div class="help-section">
          <p class="help-heading">H. 저장 관련 안내</p>
          <ul>
            <li>저장은 각자 기기/브라우저에 개별 저장됩니다(서로 공유되지 않음).</li>
            <li>다른 기기에서 이어하려면 별도 기능이 필요합니다(추후 업데이트).</li>
          </ul>
        </div>
      </div>
      <div class="modal-actions">
        <button id="helpClose">닫기</button>
      </div>
    </div>
  </div>

  <div id="tutorialModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="tutorialTitle">
    <div class="modal-inner">
      <h3 id="tutorialTitle">처음 오셨나요?</h3>
      <div class="modal-body tutorial-content">
        <ul>
          <li>하루 진행으로 시간이 흐릅니다.</li>
          <li>노동 배치가 생산을 결정합니다.</li>
          <li>식량이 바닥나지 않게 유지하세요.</li>
          <li>치안이 낮으면 범죄/폭동 위험이 올라갑니다.</li>
          <li>저장을 자주 하세요.</li>
        </ul>
      </div>
      <div class="modal-actions">
        <button id="tutorialStart">시작하기</button>
      </div>
    </div>
  </div>

  <footer class="footer">
    <span class="muted small">팁: 초반엔 농부/목수로 안정화 → 저장고/농장 확장 → 경비병/성벽으로 안전 확보.</span>
  </footer>

  <script src="./game.js"></script>
</body>
</html>
